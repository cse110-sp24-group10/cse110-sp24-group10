<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>calendar/calendar.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addDayClickEvent">addDayClickEvent</a></li><li><a href="global.html#createCalendar">createCalendar</a></li><li><a href="global.html#filterTasksByTag">filterTasksByTag</a></li><li><a href="global.html#loadTasksForDate">loadTasksForDate</a></li><li><a href="global.html#sortTasksByDate">sortTasksByDate</a></li><li><a href="global.html#sortTasksByDateDescending">sortTasksByDateDescending</a></li><li><a href="global.html#sortTasksByName">sortTasksByName</a></li><li><a href="global.html#sortTasksByNameDescending">sortTasksByNameDescending</a></li><li><a href="global.html#sortTasksByTag">sortTasksByTag</a></li><li><a href="global.html#sortTasksByTagDescending">sortTasksByTagDescending</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">calendar/calendar.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// Select necessary elements from the DOM
const monthYear = document.querySelector(".monthANDyear");
dayTag = document.querySelector(".day");
toggleIcons = document.querySelectorAll(".icons span");
const popup = document.getElementById("popup");
const popupDate = document.getElementById("popup-date");
const taskList = document.getElementById("task-list");
const closeBtn = document.querySelector(".popup .close");
let date = new Date(),
    currYear = date.getFullYear(),
    currMonth = date.getMonth();
currDay = date.getDate();
//date to local storage for linking to other pages
let selectedDate = new Date(currYear, currMonth, currDay);
localStorage.setItem("selectedDate", JSON.stringify(selectedDate));

/**
 * Load tasks for a specific date from localStorage and display them in the task list.
 * @param {Date} date - The date for which tasks need to be loaded.
 */
const loadTasksForDate = (date) => {
  const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
  const tags = JSON.parse(localStorage.getItem('tags')) || [];
  const tasksForTheDay = tasks.filter(task => {
      const taskDate = new Date(task.date);
      const adjustedTaskDate = new Date(taskDate.getTime() + taskDate.getTimezoneOffset() * 60000);
      return adjustedTaskDate.toDateString() === date.toDateString();
  });

  if (tasksForTheDay.length > 0) {
      // Sort tasks by completion status: incomplete tasks first
      tasksForTheDay.sort((a, b) => a.completed - b.completed);

      taskList.innerHTML = tasksForTheDay.map(task => {
          const tag = tags.find(t => t.name === task.tag);
          const time = task.time;
          const [hours, minutes] = time.split(':');
          let hour = parseInt(hours);
          const ampm = hour >= 12 ? 'PM' : 'AM';
          hour = hour % 12 || 12;
          const formattedTime = hour + ":" + minutes + " " + ampm;
          const completed = task.completed ? 'Completed' : 'Not Completed';
          const statusClass = task.completed ? 'completed' : 'not-completed';
          let difficulty = '';
          if (task.difficulty === "blue") {
              difficulty = "Very Easy";
          } else if (task.difficulty === "green") {
              difficulty = "Easy";
          } else if (task.difficulty === "yellow") {
              difficulty = "Medium";
          } else if (task.difficulty === "orange") {
              difficulty = "Hard";
          } else {
              difficulty = "Very Hard";
          }
          return `
              &lt;div class="task-item ${statusClass}">
                  &lt;span class="task-name">${task.name}&lt;/span>
                  ${task.tag &amp;&amp; tag ? `&lt;span class="task-tag" style="background-color: ${tag.color};">${tag.name}&lt;/span>` : ''}
                  ${task.difficulty ? `&lt;span class="task-difficulty" style="background-color: ${task.difficulty};">${difficulty}&lt;/span>` : ''}
                  ${task.time ? `&lt;span class="task-date">${formattedTime}&lt;/span>` : `&lt;span class="task-date">All Day&lt;/span>`}
              &lt;/div>`;
      }).join('');
  } else {
      taskList.innerHTML = '&lt;li class="noTask">No tasks for today.&lt;/li>';
  }
};



/**
 * Event listener to load tasks when the window loads.
 */
window.addEventListener("load", () => {
    const today = new Date();
    // Display today's date in the popup
    popupDate.innerText = `${months[today.getMonth()]} ${today.getDate()}, ${today.getFullYear()}`;
    loadTasksForDate(today);
    popup.style.display = "flex"; // Show the popup
});

/**
 * Add click event to each day element to display tasks for the selected day.
 */
const addDayClickEvent = () => {
    document.querySelectorAll(".day li").forEach(day => {
        day.addEventListener("click", () => {
            const selectedDay = day.innerText;
            let selectedDate = new Date(currYear, currMonth, selectedDay);
            // Adjust date if day is from the previous or next month
            if (day.classList.contains("faded-past")) {
                selectedDate = new Date(currYear, currMonth - 1, selectedDay);
            } else if (day.classList.contains("faded-future")) {
                selectedDate = new Date(currYear, currMonth + 1, selectedDay);
            }
            // Update popup with the selected date and load tasks
            popupDate.innerText = `${months[selectedDate.getMonth()]} ${selectedDay}, ${selectedDate.getFullYear()}`;
            loadTasksForDate(selectedDate);
            popup.style.display = "flex"; // Show the popup
            //save to local storage for calendar access
            localStorage.setItem("selectedDate", JSON.stringify(selectedDate));
        });
    });
};

// Event listener to close the popup when the close button is clicked
closeBtn.addEventListener("click", () => {
    popup.style.display = "none";
});

// Event listener to close the popup when clicking outside of it
window.addEventListener("click", (event) => {
    if (event.target == popup) {
        popup.style.display = "none";
    }
});


// List of months to choose from
const months = ["January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December"];

/**
 * Function to create the calendar for the current month and year.
 * Dynamically updates the days displayed based on the current month and year.
 */
const createCalendar = () => {
    monthYear.innerText = `${months[currMonth]} ${currYear}`;
    let firstDayOfMonth = new Date(currYear, currMonth, 1).getDay();
    let lastDateOfMonth = new Date(currYear, currMonth + 1, 0).getDate();
    let prevLastDateOfMonth = new Date(currYear, currMonth, 0).getDate();
    let lastDayOfMonth = new Date(currYear, currMonth, lastDateOfMonth).getDay();
    let liTag = "";

    // List dates of the previous month
    for (let i = firstDayOfMonth; i > 0; i--) {
        liTag += `&lt;li class="faded-past">${prevLastDateOfMonth - i + 1}&lt;/li>`;
    }
    // List dates of the current month
    for (let i = 1; i &lt;= lastDateOfMonth; i++) {
        // Highlight today's date
        let today = "";
        if (i === date.getDate() &amp;&amp; currMonth === new Date().getMonth() &amp;&amp; currYear === new Date().getFullYear()) {
            today = "highlighted";
        }
        liTag += `&lt;li class="${today}">${i}&lt;/li>`;
    }
    // List dates of the next month (first few days)
    for (let i = lastDayOfMonth; i &lt; 6; i++) {
        liTag += `&lt;li class="faded-future">${i - lastDayOfMonth + 1}&lt;/li>`;
    }

    dayTag.innerHTML = liTag; // Update the calendar days
    addDayClickEvent(); // Ensure event listeners are added after calendar is created
};
createCalendar();

/**
 * Event listeners for month navigation icons.
 * Adds click event listeners to the toggle icons for navigating months.
 */
toggleIcons.forEach(icon => {
    icon.addEventListener("click", () => {
        // If previous button is clicked, decrement the month; otherwise, increment the month
        if (icon.id === "prev") {
            currMonth = currMonth - 1;
        } else {
            currMonth += 1;
        }
        // Update the year if scrolling past or before the current year
        if (currMonth &lt; 0 || currMonth > 11) {
            date = new Date(currYear, currMonth);
            currYear = date.getFullYear();
            currMonth = date.getMonth();
        } else {
            date = new Date();
        }
        createCalendar(); // Recreate the calendar with the new month and year
    });
});

/**
 * Event listener for the "Add Task" button.
 * Redirects to the tasks page to add a new task.
 */
addTaskBtn.addEventListener("click", () => {
    window.location.href = "../tasks/tasks.html"; // Redirect to the tasks page to add a new task
});

/**
 * Event listener for the "Journal Link" button.
 * Redirects to the journal page.
 */
journalLinkBtn.addEventListener("click", () => {
    window.location.href = "../journal/journal.html"; // Redirect to the journal page
});

/**
 * JavaScript code for keyboard accessibility and navigation.
 * Handles keyboard navigation within the calendar.
 */
document.addEventListener('DOMContentLoaded', function() {
    const days = document.querySelectorAll('.calendar .day li'); // Select all calendar days
    let focusedIndex = -1; // Variable to track the currently focused day

    /**
     * Function to handle keyboard navigation.
     * @param {KeyboardEvent} event - The keyboard event.
     */
    function handleKeyNavigation(event) {
        switch(event.key) {
            case 'ArrowRight': // Move focus to the next day
                if (focusedIndex &lt; days.length - 1) {
                    focusedIndex++;
                    days[focusedIndex].focus();
                }
                break;
            case 'ArrowLeft': // Move focus to the previous day
                if (focusedIndex > 0) {
                    focusedIndex--;
                    days[focusedIndex].focus();
                }
                break;
            case 'ArrowDown': // Move focus to the day below
                if (focusedIndex + 7 &lt; days.length) {
                    focusedIndex += 7;
                    days[focusedIndex].focus();
                }
                break;
            case 'ArrowUp': // Move focus to the day above
                if (focusedIndex - 7 >= 0) {
                    focusedIndex -= 7;
                    days[focusedIndex].focus();
                }
                break;
            case 'Enter': // Open the popup for the focused day
                if (focusedIndex >= 0) {
                    days[focusedIndex].click();
                }
                break;
            case 'Tab': // Allow tabbing through focusable elements
                if (event.shiftKey &amp;&amp; focusedIndex === 0) {
                    focusedIndex = -1;
                } else if (!event.shiftKey &amp;&amp; focusedIndex === days.length - 1) {
                    focusedIndex = -1;
                }
                break;
        }
    }

    // Add tabindex and aria roles to make days focusable
    days.forEach((day, index) => {
        day.setAttribute('tabindex', '0');
        day.setAttribute('role', 'button');
        day.addEventListener('focus', () => focusedIndex = index); // Update focusedIndex when a day gets focus
    });

    // Event listener for keyboard navigation
    document.addEventListener('keydown', handleKeyNavigation);
});

/* 
 * Added keyboard navigation support using arrow keys and enter key
 * - ArrowRight: Move focus to the next day
 * - ArrowLeft: Move focus to the previous day
 * - ArrowDown: Move focus to the day below
 * - ArrowUp: Move focus to the day above
 * - Enter: Open the popup for the focused day
 * - Tab: Allow tabbing through focusable elements
 */
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.3</a> on Sun Jun 09 2024 21:48:08 GMT-0700 (Pacific Daylight Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
